{"version":3,"file":"loadModule.js","sourceRoot":"","sources":["../../../tests/_support/loadModule.ts"],"names":[],"mappings":";;;;;;;;;;;IAAA,iCAAmC;IACnC,6BAA+B;IAE/B,oBAAsC,OAAoB,EAAE,GAAW,EAAE,KAAU,EAAE,aAA6B;QAA7B,8BAAA,EAAA,oBAA6B;QACjH,IAAM,mBAAmB,GAAG,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAEjD,OAAO,CAAC,MAAM,CAAC;YACd,aAAa,EAAE,IAAI;YACnB,aAAa,EAAE,KAAK;YACpB,kBAAkB,EAAE,KAAK;SACzB,CAAC,CAAC;QACH,OAAO,CAAC,UAAU,EAAE,CAAC;QAErB,GAAG,CAAC,CAAC,IAAM,KAAG,IAAI,KAAK,CAAC,CAAC,CAAC;YACzB,OAAO,CAAC,YAAY,CAAC,KAAG,EAAE,KAAK,CAAC,KAAG,CAAC,CAAC,CAAC;QACvC,CAAC;QAED,OAAO,CAAC,YAAY,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;QAErC,IAAM,MAAM,GAAG,OAAO,CAAC,mBAAmB,CAAC,CAAC;QAC5C,MAAM,CAAC,aAAa,IAAI,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC;IAClE,CAAC;IAlBD,6BAkBC;IAED;QACC,OAAO,CAAC,aAAa,EAAE,CAAC;QACxB,OAAO,CAAC,OAAO,EAAE,CAAC;IACnB,CAAC;IAHD,gDAGC","sourcesContent":["import * as mockery from 'mockery';\nimport * as tslib from 'tslib';\n\nexport default function loadModule<T>(require: NodeRequire, mid: string, mocks: any, returnDefault: boolean = true): T {\n\tconst moduleUnderTestPath = require.resolve(mid);\n\n\tmockery.enable({\n\t\tuseCleanCache: true,\n\t\twarnOnReplace: false,\n\t\twarnOnUnregistered: false\n\t});\n\tmockery.resetCache();\n\n\tfor (const mid in mocks) {\n\t\tmockery.registerMock(mid, mocks[mid]);\n\t}\n\n\tmockery.registerMock('tslib', tslib);\n\n\tconst module = require(moduleUnderTestPath);\n\treturn returnDefault && module.default ? module.default : module;\n}\n\nexport function cleanupModuleMocks() {\n\tmockery.deregisterAll();\n\tmockery.disable();\n}\n"]}